---
layout: post
title:  "10.데이터 탐색과 시각화"
date:   2024-07-21 17:55:22 +09:00
categories: ['ML기초세션']
---

# 1. EDA
EDA란 Exploratory Data Analysis, 즉 탐색적 데이터 분석을 의미한다.   
이때 **기술통계**와 **데이터 시각화**를 통해 데이터의 특성을 파악한다.   

- 데이터의 형태와 척도가 분석에 알맞게 되어있는지 확인(sanity checking)
- 데이터의 평균, 분산, 분포, 패턴 등의 확인을 통해 데이터 특성 파악
- 데이터의 결측값이나 이상치 파악 및 보완
- 변수 간의 관계성 파악
- 분석 목적과 방향성 점검 및 보정

위와 같은 목적으로 EDA를 실시한다.

## 1-1. 엑셀을 활용한 EDA
 간단하면서 원초적인 방법이다. 말그대로 엑셀을 켜두고 확인해보는 것이다.   
 실제로 엑셀에서는 기술통계와 시각화와 관련된 여러 툴들을 손쉽게 제공한다.   
 다른 프로그램보다 기능이 적더라도 **사용자 친화**가 엑셀의 최대 장점이지 싶다.

## 1-2. 탐색적 데이터 분석 실습

교재의 실습상황을 요약하면 다음과 같다.
1. 라이브러리 import (seaborn, matplot, pandas)
2. 데이터 로드
3. 칼럼 속성 및 결측치 확인
4. 칼럼 통계치 확인
5. 칼럼 왜도, 첨도 확인
6. 시각화를 통한 특정 변수의 분포 확인
7. 그룹화를 통한 특정 변수의 분포 차이

info()는 행열크기, 칼럼 자료형, 결측값 등을 확인한다. 말그대로 데이터에 대한 **기초정보**이다.   
describe()는 기술통계학적 정보를 제공한다. 즉 기술통계학적으로 데이터를 **묘사**한 것이다.   

왜도 및 첨도의 경우 skew()와  kurtosis()로 표현가능한데, 간략하게 왜도는 분포의 좌우대칭성, 첨도는 분포의 밀집정도에 대한 개념이다.

분포는 다양한 시각화 함수를 통해 구현할 수 있다. 또한, 그룹화를 통해 원하는 그룹의 분포에 대한 시각화, 혹은 비교도 가능하다!

# 2. 공분산과 상관성 분석

상관관계란, 말 그대로 특정 변수간의 상관정도이다.
그렇다면 이 상관관계를 어떻게 나타낼 수 있을까?

상관관계는 크게 세가지 양상을 띈다. 
1. 양의 상관관계
2. 음의 상관관계
3. 관계없음

## 2-1. 공분산
공분산은 다음과 같은 수식으로 나타낸다

![alt text](image.png)

그리고 공분산은, 의미적으로 서로 공유하는 분산을 나타낸다.   
0이면 관계없음, 양수면 양의 상관관계, 음수면 음의 상관관계를 나타낸다.

## 2-2. 상관계수
그런데 문제가 있다. 변수간의 스케일이 다른데, 공분산은 이를 고려하지 못한다는 것이다.   
공분산이 1300인 것이 공분산이 800인 것보다 상관관계가 크다고 할 수 없다는 것이다.

이를 해결하기 위해 정규화를 거쳐 상관성을 비교하고, 이 중 대표적인 예가 피어슨 상관계수이다. 상관계수는 따라서 단위에 영향을 받지 않는다.  
**(이외에도 상관계수는 많이 존재함!!)**

![alt text](image-1.png)

수식은 위와 같고, 계수의 절대값은 1을 넘을 수 없다. 또한 해석에 있어서 분야마다, 해석하는 기준이 조금씩 다르지만, 일반적으로 아래와 같은 기준을 삼는다.

![alt text](image-2.png)
![alt text](image-3.png)

회기분석에서 결정계수는 이 상관계수를 제곱한 값을 사용한다.

### !!!주의할 점!!! ###   
**상관계수가 높다는 것은 기울기와 무관하다. 설명력이 높다는 것이다.**
산점도의 기울기가 크다고 상관계수가 크다고 생각하지 말자.
- 기울기(Slope)는 단순히 종속 변수에 의한 독립 변수의 수치적 변화량(Delta)이다.   
- 반면에 상관계수는 두 변수의 선형관계의 강도와 방향의 개념이다.
- 선형 강도가 강하다는 쉽게 말해, 두 변수간의 관계가 예측 가능하고, 예외가 적다는 의미이다. 

![alt text](image-4.png)   
+변수의 척도가 무엇이냐에 따라 사용하는 분석기법이 달라질 수 있다!

# 3. 시간 시각화
시점 요소, 즉 시간에 대한 정보를 담고 있는 경우 시계열 형태로 표현이 가능하다.   
시간 흐름에 따라 데이터의 변화를 트래킹한다는 것이다.

## 3-1. 연속형

시간의 간격의 밀도가 높다면 선그래프를 이용해 나타낸다. 하지만 데이터의 양이 많거나, 변동이 심할 경우 **추세선**을 삽입하는 방식을 이용한다.

일반적인 방법은 이동평균(MA,Moving Average)이다. 주식에서의 이평선을 생각하면 이해가 빠를듯 싶다.

![alt text](image-5.png)

## 3-2. 분절형

분절형은 우리가 일상에서도 많이 보는 막대그래프, 누적 막대그래프 등으로 표현한다.
시간의 밀도가 낮은 경우에 사용하기에 적합하다.
![alt text](image-6.png)

# 4. 비교 시각화
그룹별 차이를 단편적으로 나타낸다면 막대그래프로도 가능하다.   
하지만 요소가 많아지면 효율적인 방법을 추구해야하는데, 이떄 **히트맵 차트**를 이용한다.   
상관계수 분석에서 흔히 히트맵을 사용하는데, 동일한 개념이다. 셀의 색상, 채도를 통해서 데이터를 표현하는 기법이다.

![alt text](image-7.png)

다음으로, 방사형 차트(Rader Chart)라는 것이 있는데, 게임에서 능력치 표시할때 사용하는 그 방법이다. 따로따로 그룹별로 확인도 가능하고, 합쳐서 확인도 가능하다.

평행 좌표 그래프(Parallel Coordinates)는 그냥 평행 방향으로 데이터셋을 뿌려 비교한 것이라 이해하면 간단하다.   
참고로, 정규화를 통해 최소값을 0%, 최대값을 100%에 변환하는 식으로 차이를 극대화할 수 있다!

![alt text](image-9.png)

# 5. 분포 시각화

분포는 굉장히 중요하다. 이를 시각화하는 것도 매우 중요하다.   

## 5-1. 양적 척도(연속형) 
보통 히스토그램을 많이 이용한다.    
하나 짚고 넘어가자면, 보통 가로 구간을 bin이라고 표현하니 bin이라는 표현이 나온다면 인지해 두도록 하자. 세로의 높이, 즉 구간의 밀도는 density라고 한다.

![alt text](image-10.png)
## 5-2. 질적 척도(구간형)

파이차트나 도넛 차트를 이용한다. 근본적으로 100%를 전체로 나눠먹는다는 개념에서 동일하다.
그냥 추가 정보를 담거나, 디자인적인 차이만 존재한다고 보면된다.

![alt text](image-11.png)

이외의 방법으로는 트리맵 차트, 와플 차트 등이 존재한다.
- 트리맵 차트: 사각형 안에 사각형을 쪼개어 분포를 표시한다. 위계구조와 비율을 시각적으로 표현.
- 와플 차트: 일정한 네모 조각으로 분포를 표현, 하지만 위계구조는 표현 못함.

# 6. 관계 시각화 (Scatter Plot)

산점도(Scatter Plot)는 두 변수 간의 관계를 시각적으로 표현한 그래프이다. 각 점은 두 변수의 값을 나타내며, X축과 Y축에 각각의 변수 값이 대응된다.

![alt text](image-12.png)

산점도의 특징과 목적
- 데이터 포인트: 각 점은 한 개체나 관측치를 나타내며, X축과 Y축 좌표는 두 변수의 값을 나타낸다.
- 관계 시각화: 두 변수 간의 관계를 시각적으로 확인할 수 있으며, 데이터가 어떻게 분포되어 있는지, 어떤 패턴이나 트렌드가 있는지 등을 파악할 수 있다.
- 선형성: 데이터가 일직선에 가까운 형태로 분포되어 있으면, 두 변수 간에 선형 관계가 있을 가능성이 높다.
- 이상치 식별: 산점도를 통해 데이터에서 벗어난 이상치를 쉽게 식별할 수 있다.

**이러한 이유로 산점도를 관계 시각화에서 유용하게 사용한다.** 

# 7. 공간 시각화
실제 지리정보와 결합하여 지도위에 데이터를 표현하는 방식이다.   
당연하게도, 실제 지도위에 구현을 하고 구체적으로 표현하기에 다양한 라이브러리와 데이터들의 도움이 필요하다. 확실히 위의 기법들 보다 신경 쓸 요소가 많다.
- 도트맵: 점을 찍어 분포나 패턴을 확인
- 버블맵: 원의 크기로 데이터 값 확인
- 코로플레스맵: 단계 구분도라고 하며, 데이터 값에 따라 색상과 음영을 달리해 표현 
- 커넥션맵: 지도 상의 점들의 관계를 표현

이외에도 다양한 표현방법들이 존재한다.

# 8. 박스 플롯
박스 플롯은 상자 수염 그림이라고도 한다.
상자 모양의 그래프에 분포, 편향, 평균, 중앙값 등의 수치를 확인할 수 있는 굉장히 유용한 도구이다.

![alt text](image-13.png)

사분위의 개념과 여타 개념들은 실험통계학 시간에 공부하였으므로 생략하겠다.   
이상치 처리에 대해 주목할 만한데, **데이터 분석**에서는 극단치와 이상치를 제외한 후 최댓값을 표시하지만, 원론적으로는 극단치, 이상치 제거를 하지 않는 상황에서는 최댓값을 극단치까지 봐주는 것이 맞다.
